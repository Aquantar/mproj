

<!DOCTYPE html>
<html class="writer-html5" lang="English" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model Training &mdash; Jopp_PJS 16.05.2025 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=1d209903" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5c80bd1b"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Feature Prediction" href="code_createPrediction.html" />
    <link rel="prev" title="Training new Models" href="trainingNewModels.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Jopp_PJS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="usecase.html">Use Case</a></li>
<li class="toctree-l1"><a class="reference internal" href="toolOverview.html">Tool Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick Start:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tool Framework:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="problem_description.html">Problem Formulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="selected_algorithms.html">Solution Approach</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tool Usage:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="predicting_new_vals.html">Predicting new Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring_performance.html">Monitoring Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainingNewModels.html">Training new Models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Functionality:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model Training</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#function-model-training">Function: model_training</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#purpose">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#process">Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#returns">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#function-trainnewmodel">Function: trainNewModel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#function-preparerawdata">Function: prepareRawData</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#function-converttextcolumntonumbers">Function: convertTextColumnToNumbers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id11">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#function-randomforest">Function: randomForest</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id16">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#function-knn">Function: knn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id21">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#function-svm">Function: svm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id26">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id30">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#function-neuralnetwork">Function: neuralNetwork</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id31">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id32">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id33">Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">Notes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_createPrediction.html">Feature Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_modelMonitoring.html">Model Management</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Jopp_PJS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Model Training</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/your-github-username/your-repo-name/blob/main/docs/code_trainNewModel.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-training">
<h1>Model Training<a class="headerlink" href="#model-training" title="Link to this heading"></a></h1>
<section id="function-model-training">
<h2>Function: model_training<a class="headerlink" href="#function-model-training" title="Link to this heading"></a></h2>
<section id="purpose">
<h3>Purpose<a class="headerlink" href="#purpose" title="Link to this heading"></a></h3>
<p>This function is part of routes.py and initializes the re-training of new models when the corresponding button is pressed on the web-UI. It further manages existing models after training is completed.</p>
</section>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>None</p></li>
</ul>
</section>
<section id="process">
<h3>Process<a class="headerlink" href="#process" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Versioning of existing model generations is managed</p></li>
<li><p>Training data for new model generation is created by combining data used for previous model with saved, currently unused input tuples</p></li>
<li><p>Training of a model for each desired output feature is initialized by calling <span class="varname">trainNewModel</span>, and training progress is tracked</p></li>
<li><p>Updated monitoring web-page is displayed after successful training</p></li>
</ol>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Re-route to updated <span class="varname">monitoring.html</span></p></li>
</ul>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Built by: Serdar, Johannes (Corresponding Web-Overlay <span class="varname">monitoring.html</span> built by Johannes)</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/model_training&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">model_training</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">outputCols</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dir1</span> <span class="o">=</span> <span class="s1">&#39;models//model1&#39;</span>
            <span class="n">dir2</span> <span class="o">=</span> <span class="s1">&#39;models//model2&#39;</span>
            <span class="n">dir3</span> <span class="o">=</span> <span class="s1">&#39;models//model3&#39;</span>

            <span class="c1">#move existing models &quot;down&quot; one folder (versioning)</span>
            <span class="k">for</span> <span class="n">fileName</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dir2</span><span class="p">):</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir2</span><span class="p">,</span> <span class="n">fileName</span><span class="p">),</span> <span class="n">dir3</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">fileName</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dir1</span><span class="p">):</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir1</span><span class="p">,</span> <span class="n">fileName</span><span class="p">),</span> <span class="n">dir2</span><span class="p">)</span>

            <span class="c1">#combine existing train data with new rows</span>
            <span class="n">trainData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;models//model1//currentTrainData.xlsx&#39;</span><span class="p">)</span>
            <span class="n">trainDataNew</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;models//stashedTrainData.xlsx&#39;</span><span class="p">)</span>
            <span class="n">trainData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">trainData</span><span class="p">,</span> <span class="n">trainDataNew</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

            <span class="c1">#train new models</span>
            <span class="n">accuracyList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">total_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">outputCols</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>  <span class="c1">#steps = col count + preprocessing + metrics</span>

            <span class="c1">#preprocessing</span>
            <span class="n">progress</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Preprocessing abgeschlossen (</span><span class="si">{</span><span class="n">progress</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_steps</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

            <span class="c1">#model training for each output col</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">outputCols</span><span class="p">:</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">conversionMap</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">trainNewModel</span><span class="p">(</span><span class="n">trainData</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;models//model1//</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span>
                <span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;models//model1//scaler.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span>
                <span class="n">dump</span><span class="p">(</span><span class="n">conversionMap</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;models//model1//conversionMap.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span>
                <span class="n">accuracyList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
                <span class="n">progress</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modell für &#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&#39; trainiert (</span><span class="si">{</span><span class="n">progress</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_steps</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

            <span class="c1">#export training data</span>
            <span class="n">trainData</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;models//model1//currentTrainData.xlsx&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">trainData</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">))</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;models//stashedTrainData.xlsx&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1">#refresh model metrics file</span>
            <span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;models//modelData.xlsx&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">modelMetrics</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="s1">&#39;modelID&#39;</span> <span class="ow">in</span> <span class="n">modelMetrics</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">last_model_id</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[</span><span class="s1">&#39;modelID&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">modelID</span> <span class="o">=</span> <span class="n">last_model_id</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">modelID</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1">#start from 1 if file is empty or column missing</span>
            <span class="n">newrow</span> <span class="o">=</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="n">accuracyList</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">modelMetrics</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newrow</span>
            <span class="n">modelMetrics</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;models//modelData.xlsx&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">progress</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modellmetriken aktualisiert (</span><span class="si">{</span><span class="n">progress</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_steps</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

            <span class="c1">#prepare loading of monitoring page</span>
            <span class="c1">#load current model metrics</span>
            <span class="n">accuracyData</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="s1">&#39;accuracy_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
                <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="s1">&#39;accuracy_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
                <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="s1">&#39;accuracy_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
            <span class="p">]</span>
            <span class="n">last_row</span> <span class="o">=</span> <span class="n">modelMetrics</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1">#load relevant data about current model</span>
            <span class="n">last_row</span> <span class="o">=</span> <span class="n">modelMetrics</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">predictionStats</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;totalPredictions&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;totalPredictions&#39;</span><span class="p">]),</span>
                <span class="s1">&#39;predictionChanged&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;predictionChanged&#39;</span><span class="p">]),</span>
                <span class="s1">&#39;predictionChangeRatio&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;predictionChangeRatio&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span>
            <span class="p">}</span>
            <span class="n">modelIDs</span> <span class="o">=</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="s1">&#39;modelID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

            <span class="c1">#output monitoring page</span>
            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&quot;monitoring.html&quot;</span><span class="p">,</span> <span class="n">accuracyData</span><span class="o">=</span><span class="n">accuracyData</span><span class="p">,</span> <span class="n">modelIDs</span><span class="o">=</span><span class="n">modelIDs</span><span class="p">,</span> <span class="n">predictionStats</span><span class="o">=</span><span class="n">predictionStats</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fehler beim Modelltraining: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">flash</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fehler beim Modelltraining: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;stasheddata&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;stasheddata&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="function-trainnewmodel">
<h2>Function: trainNewModel<a class="headerlink" href="#function-trainnewmodel" title="Link to this heading"></a></h2>
<section id="id1">
<h3>Purpose<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>This function fully delegates the training of new predictive model for a single desired output feature, including data preprocessing, model training, and final model selection.</p>
</section>
<section id="id2">
<h3>Parameters<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">outputFeature</span> (string): The feature to be predicted based on input data</p></li>
<li><p><span class="varname">trainData</span> (dataframe): The set of raw training data</p></li>
</ul>
</section>
<section id="id3">
<h3>Process<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Data Pre-Processing:</dt><dd><ul class="simple">
<li><p>Function <span class="varname">prepareRawData</span> is called, which cleans the training data before further processing</p></li>
<li><p>Conversion Map Creation: A dictionary that maps each unique value in the training data to a number which is unique within that feature column is created, and the training data is translated into a numeric form using this dictionary</p></li>
<li><p>Training/Testing Split: The data is split into a training/testing set at an 80/20 ratio, and is further divided into input features and a desired output feature, resulting in <span class="varname">X_train</span>, <span class="varname">X_test</span>, <span class="varname">y_train</span>, <span class="varname">y_test</span></p></li>
<li><p>Input Feature Scaling: Input features are scaled to values between 0 and 1</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Model Training:</dt><dd><ul class="simple">
<li><p>Models using each of the four selected algorithms are trained using the prepared training data through the functions <span class="varname">randomForest</span>, <span class="varname">knn</span>, <span class="varname">svm</span>, and <span class="varname">neuralNetwork</span></p></li>
<li><p>The best performing models from each algorithm are compared, and the single model with the highest <span class="varname">accuracy_score</span> is selected as the final model for the currently desired output feature</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</section>
<section id="id4">
<h3>Returns<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">res[0]</span> : The selected model</p></li>
<li><p><span class="varname">scaler</span> : The scaler built for model training</p></li>
<li><p><span class="varname">conversionMap</span> (dictionary): The dictionary which contains the built mapping between text values in the original input data and the numeric values used in training</p></li>
<li><p><span class="varname">res[2]</span> (float): The accuracy of the selected model</p></li>
</ul>
</section>
<section id="id5">
<h3>Notes<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The built scaler as well as conversion map are saved after model training to be used when predicting new values with that pre-trained model</p></li>
<li><p>Built by: Serdar</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">trainNewModel</span><span class="p">(</span><span class="n">trainData</span><span class="p">,</span> <span class="n">outputFeature</span><span class="p">):</span>
    <span class="n">trainData</span> <span class="o">=</span> <span class="n">prepareRawData</span><span class="p">(</span><span class="n">trainData</span><span class="p">)</span> <span class="c1">#prepare raw data for model training</span>

    <span class="c1">#create conversion map</span>
    <span class="n">conversionMap</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">allCols</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">trainData</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">conversionOutput</span> <span class="o">=</span> <span class="n">convertTextColumnToNumbers</span><span class="p">(</span><span class="n">trainData</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="n">trainData</span> <span class="o">=</span> <span class="n">conversionOutput</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">trainData</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">trainData</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
            <span class="n">conversionMap</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">conversionOutput</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1">#create split</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">trainData</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">outputCols</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">trainData</span><span class="p">[</span><span class="n">outputFeature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="c1">#scale data</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
    <span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1">#train models</span>
    <span class="n">modelDict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">modelDict</span><span class="p">[</span><span class="s2">&quot;RF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">randomForest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">outputFeature</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; (RF): &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modelDict</span><span class="p">[</span><span class="s2">&quot;RF&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">modelDict</span><span class="p">[</span><span class="s2">&quot;KNN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">outputFeature</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; (KNN): &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modelDict</span><span class="p">[</span><span class="s2">&quot;KNN&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">modelDict</span><span class="p">[</span><span class="s2">&quot;SVM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">svm</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">outputFeature</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; (SVM): &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modelDict</span><span class="p">[</span><span class="s2">&quot;SVM&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">modelDict</span><span class="p">[</span><span class="s2">&quot;MLP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">neuralNetwork</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">outputFeature</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; (MLP): &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modelDict</span><span class="p">[</span><span class="s2">&quot;MLP&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>

    <span class="c1">#select model with highest accuracy</span>
    <span class="n">keySelected</span> <span class="o">=</span> <span class="s2">&quot;RF&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">modelDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">modelDict</span><span class="p">[</span><span class="n">keySelected</span><span class="p">][</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">keySelected</span> <span class="o">=</span> <span class="n">key</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected model: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">keySelected</span><span class="p">))</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">modelDict</span><span class="p">[</span><span class="n">keySelected</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">conversionMap</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="function-preparerawdata">
<h2>Function: prepareRawData<a class="headerlink" href="#function-preparerawdata" title="Link to this heading"></a></h2>
<section id="id6">
<h3>Purpose<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<p>This function cleans a dataframe which contains raw data before use in model training or output feature prediction</p>
</section>
<section id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">data</span> (dataframe): The set of raw training data to be cleaned</p></li>
</ul>
</section>
<section id="id8">
<h3>Process<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Qualitative component characteristics are removed, as only quantitative characteristics are predictable</p></li>
<li><p>The data column 'Prüfmerkmal_Text' is cleaned and unnecessary suffixes are removed</p></li>
<li><p>Unused columns are removed</p></li>
<li><p>Empty cells are filled with '0'</p></li>
<li><p>Values which should be numeric are correctly formatted</p></li>
<li><p>Dataframe is converted to string type</p></li>
</ol>
</section>
<section id="id9">
<h3>Returns<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">data</span> (dataframe): The set of data after pre-processing is completed</p></li>
</ul>
</section>
<section id="id10">
<h3>Notes<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Built by: Serdar</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">prepareRawData</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1">#entferne qualitative merkmale</span>
    <span class="k">if</span> <span class="s1">&#39;Qualitatives_Merkmal&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Qualitatives_Merkmal&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;X&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Qualitatives_Merkmal&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#fülle prüfmerkmals-text mit werten aus anderer spalte falls nötig</span>
    <span class="k">if</span> <span class="s1">&#39;Produktmerkmal_Text&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">newval</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Produktmerkmal_Text&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">newval</span> <span class="o">=</span> <span class="n">newval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;Produktmerkmal_Text&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">newval</span>

    <span class="c1">#entferne nicht verwendete spalten</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allCols</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">col</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#fülle leere zellen mit 0</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">#formatiere zahlen zu korrektem dezimalformat (, statt .) und wandle in float um</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">]):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;Oberer_Grenzwert&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Oberer_Grenzwert&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;Oberer_Grenzwert&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Oberer_Grenzwert&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;Unterer_Grenzwert&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Unterer_Grenzwert&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;Unterer_Grenzwert&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Unterer_Grenzwert&#39;</span><span class="p">])</span>

    <span class="c1">#wandle zellen &quot;Unterer Grenzwert&quot; und &quot;Oberer Grenzwert&quot; in differenzen statt absolute zahlen um</span>
    <span class="n">list_lower</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">list_upper</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">list_lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Unterer_Grenzwert&#39;</span><span class="p">])</span>
        <span class="n">list_upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Oberer_Grenzwert&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Spezifikation&#39;</span><span class="p">])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Unterer_Grenzwert&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">list_lower</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Oberer_Grenzwert&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">list_upper</span>

    <span class="c1">#wandle alle spalten in string um</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</section>
</section>
<section id="function-converttextcolumntonumbers">
<h2>Function: convertTextColumnToNumbers<a class="headerlink" href="#function-converttextcolumntonumbers" title="Link to this heading"></a></h2>
<section id="id11">
<h3>Purpose<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<p>This function creates a corresponding number for each unique value in a dataframe column in order to create the conversion map built during model training, and replaces the original values within that column with their corresponding number. A dictionary which maps each original value to a specific number is used at a later point to re-convert numeric values to their original form.</p>
</section>
<section id="id12">
<h3>Parameters<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">data</span> (dataframe): The set of data to be used for training</p></li>
<li><p><span class="varname">colname</span> (string): The name of the column of which the values are to be converted into numeric values</p></li>
</ul>
</section>
<section id="id13">
<h3>Process<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>For each unique value within the selected column, an ascending number is chosen and the value-number pairs are saved</p></li>
<li><p>All values within the selected column are replaced by their corresponding number</p></li>
</ol>
</section>
<section id="id14">
<h3>Returns<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">data</span> (dataframe): The set of data with numeric values in the selected column</p></li>
<li><p><span class="varname">map_uniqueValues</span> (dictionary): The dictionary containing the different value-number pairs</p></li>
</ul>
</section>
<section id="id15">
<h3>Notes<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Built by: Serdar</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convertTextColumnToNumbers</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">colname</span><span class="p">):</span>
    <span class="c1">#wandelt eine spalte mit textwerten in einem dataframe in zahlen um und speichert text/zahlenpaare für spätere rückwandlung</span>
    <span class="n">list_uniqueValues</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">map_uniqueValues</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">intTemp</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">list_uniqueValues</span><span class="p">:</span>
        <span class="n">map_uniqueValues</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">intTemp</span>
        <span class="n">intTemp</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="n">colname</span><span class="p">]</span><span class="o">=</span><span class="n">map_uniqueValues</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">colname</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">map_uniqueValues</span>
</pre></div>
</div>
</section>
</section>
<section id="function-randomforest">
<h2>Function: randomForest<a class="headerlink" href="#function-randomforest" title="Link to this heading"></a></h2>
<section id="id16">
<h3>Purpose<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<p>This function trains a model using <span class="varname">RandomForestClassifier</span> which is part of the <span class="varname">sklearn.ensemble</span> package.</p>
</section>
<section id="id17">
<h3>Parameters<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">X_train</span> (dataframe): Input features used for model training</p></li>
<li><p><span class="varname">X_test</span> (dataframe): Input features used for model validation</p></li>
<li><p><span class="varname">y_test</span> (dataframe): Output features used for model training</p></li>
<li><p><span class="varname">y_test</span> (dataframe):Output features used for model validation</p></li>
</ul>
</section>
<section id="id18">
<h3>Process<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Model is created and fitted on training data</p></li>
<li><p>A set of predictions is performed using <span class="varname">X_test</span>. The results are compared with <span class="varname">y_test</span>, and an <span class="varname">accuracy_score</span> is calculated</p></li>
</ol>
</section>
<section id="id19">
<h3>Returns<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">model</span>: The trained model</p></li>
<li><p><span class="varname">y_pred</span> (dataframe): The dataframe which contains the predicted values for validation purposes</p></li>
<li><p><span class="varname">accuracy</span> (float): The resulting model accuracy</p></li>
</ul>
</section>
<section id="id20">
<h3>Notes<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Built by: Serdar</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">randomForest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;entropy&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="function-knn">
<h2>Function: knn<a class="headerlink" href="#function-knn" title="Link to this heading"></a></h2>
<section id="id21">
<h3>Purpose<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<p>This function trains a model using <span class="varname">KNeighborsClassifier</span> which is part of the <span class="varname">sklearn.neighbors</span> package.</p>
</section>
<section id="id22">
<h3>Parameters<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">X_train</span> (dataframe): Input features used for model training</p></li>
<li><p><span class="varname">X_test</span> (dataframe): Input features used for model validation</p></li>
<li><p><span class="varname">y_test</span> (dataframe): Output features used for model training</p></li>
<li><p><span class="varname">y_test</span> (dataframe):Output features used for model validation</p></li>
</ul>
</section>
<section id="id23">
<h3>Process<a class="headerlink" href="#id23" title="Link to this heading"></a></h3>
<p>1. A series of models is trained using <span class="varname">GridSearchCV</span>, testing a range of values for the parameters <span class="varname">n_neighbors</span> and <span class="varname">weights</span>
1. The set of best-performing parameters is selected to re-create the final model and fit it on used data
2. A set of predictions is performed using <span class="varname">X_test</span>. The results are compared with <span class="varname">y_test</span>, and an <span class="varname">accuracy_score</span> is calculated</p>
</section>
<section id="id24">
<h3>Returns<a class="headerlink" href="#id24" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">model</span>: The trained model</p></li>
<li><p><span class="varname">y_pred</span> (dataframe): The dataframe which contains the predicted values for validation purposes</p></li>
<li><p><span class="varname">accuracy</span> (float): The resulting model accuracy</p></li>
</ul>
</section>
<section id="id25">
<h3>Notes<a class="headerlink" href="#id25" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Built by: Serdar</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span>
                <span class="s1">&#39;weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]}</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">KNeighborsClassifier</span><span class="p">(),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">refit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;n_neighbors&quot;</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">],</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ball_tree&quot;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">accuracy</span>
</pre></div>
</div>
</section>
</section>
<section id="function-svm">
<h2>Function: svm<a class="headerlink" href="#function-svm" title="Link to this heading"></a></h2>
<section id="id26">
<h3>Purpose<a class="headerlink" href="#id26" title="Link to this heading"></a></h3>
<p>This function trains a model using <span class="varname">SVC</span> which is part of the <span class="varname">sklearn.svm</span> package.</p>
</section>
<section id="id27">
<h3>Parameters<a class="headerlink" href="#id27" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">X_train</span> (dataframe): Input features used for model training</p></li>
<li><p><span class="varname">X_test</span> (dataframe): Input features used for model validation</p></li>
<li><p><span class="varname">y_test</span> (dataframe): Output features used for model training</p></li>
<li><p><span class="varname">y_test</span> (dataframe):Output features used for model validation</p></li>
</ul>
</section>
<section id="id28">
<h3>Process<a class="headerlink" href="#id28" title="Link to this heading"></a></h3>
<p>1. A series of models is trained using <span class="varname">GridSearchCV</span>, testing a range of values for the parameter <span class="varname">C</span>
1. The set of best-performing parameters is selected to re-create the final model and fit it on used data
2. A set of predictions is performed using <span class="varname">X_test</span>. The results are compared with <span class="varname">y_test</span>, and an <span class="varname">accuracy_score</span> is calculated</p>
</section>
<section id="id29">
<h3>Returns<a class="headerlink" href="#id29" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">model</span>: The trained model</p></li>
<li><p><span class="varname">y_pred</span> (dataframe): The dataframe which contains the predicted values for validation purposes</p></li>
<li><p><span class="varname">accuracy</span> (float): The resulting model accuracy</p></li>
</ul>
</section>
<section id="id30">
<h3>Notes<a class="headerlink" href="#id30" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Built by: Serdar</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">svm</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">80</span><span class="p">]}</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">SVC</span><span class="p">(),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">refit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">accuracy</span>
</pre></div>
</div>
</section>
</section>
<section id="function-neuralnetwork">
<h2>Function: neuralNetwork<a class="headerlink" href="#function-neuralnetwork" title="Link to this heading"></a></h2>
<section id="id31">
<h3>Purpose<a class="headerlink" href="#id31" title="Link to this heading"></a></h3>
<p>This function trains a model using <span class="varname">MLPClassifier</span> which is part of the <span class="varname">sklearn.neural_network</span> package.</p>
</section>
<section id="id32">
<h3>Parameters<a class="headerlink" href="#id32" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">X_train</span> (dataframe): Input features used for model training</p></li>
<li><p><span class="varname">X_test</span> (dataframe): Input features used for model validation</p></li>
<li><p><span class="varname">y_test</span> (dataframe): Output features used for model training</p></li>
<li><p><span class="varname">y_test</span> (dataframe):Output features used for model validation</p></li>
</ul>
</section>
<section id="id33">
<h3>Process<a class="headerlink" href="#id33" title="Link to this heading"></a></h3>
<p>1. A series of models is trained using <span class="varname">GridSearchCV</span>, testing a range of values for the parameter <span class="varname">alpha</span>
1. The set of best-performing parameters is selected to re-create the final model and fit it on used data
2. A set of predictions is performed using <span class="varname">X_test</span>. The results are compared with <span class="varname">y_test</span>, and an <span class="varname">accuracy_score</span> is calculated</p>
</section>
<section id="id34">
<h3>Returns<a class="headerlink" href="#id34" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><span class="varname">model</span>: The trained model</p></li>
<li><p><span class="varname">y_pred</span> (dataframe): The dataframe which contains the predicted values for validation purposes</p></li>
<li><p><span class="varname">accuracy</span> (float): The resulting model accuracy</p></li>
</ul>
</section>
<section id="id35">
<h3>Notes<a class="headerlink" href="#id35" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Built by: Serdar</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">neuralNetwork</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neural_network</span><span class="w"> </span><span class="kn">import</span> <span class="n">MLPClassifier</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;adam&#39;</span><span class="p">],</span>
        <span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2000</span><span class="p">],</span>
        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="s1">&#39;hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">15</span><span class="p">,)],</span>
        <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">}</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">MLPClassifier</span><span class="p">(),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">refit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;solver&quot;</span><span class="p">],</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;max_iter&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;hidden_layer_sizes&quot;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;random_state&quot;</span><span class="p">])</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">accuracy</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="trainingNewModels.html" class="btn btn-neutral float-left" title="Training new Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="code_createPrediction.html" class="btn btn-neutral float-right" title="Feature Prediction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Serdar Isik, Johannes Klauer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>